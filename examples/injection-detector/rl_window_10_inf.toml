# Difficulty filtering active from step 10 onwards (no end)
trainer_gpu_ids = [0]
inference_gpu_ids = [1]

max_steps = 50
seq_len = 2048

[wandb]
project = "injection-detector"
name = "injection-detector-window-10-inf"

[model]
name = "Qwen/Qwen3-4B-Instruct-2507"

[orchestrator]
batch_size = 32
rollouts_per_example = 16
oversampling_factor = 2.0
max_async_level = 2

[orchestrator.sampling]
max_tokens = 4096

[[orchestrator.env]]
id = "wambosec/injection-detector"
name = "injection-detector"
args = { dataset_name = "wambosec/prompt-injections-subtle" }

[orchestrator.buffer]
online_difficulty_filtering = true
online_difficulty_filtering_start_step = 10
easy_threshold = 0.8
hard_threshold = 0.5
pool_assignment_start_step = 10
easy_fraction = 0.2
hard_fraction = 0.2

[trainer]
max_async_level = 2

[trainer.model.lora]
rank = 16
alpha = 32

[inference]
