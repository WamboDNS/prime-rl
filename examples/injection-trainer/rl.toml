trainer_gpu_ids = [0]
inference_gpu_ids = [1]

max_steps = 100
seq_len = 4096

[wandb]
project = "injection-trainer"
name = "injection-trainer"

[model]
name = "Qwen/Qwen3-4B-Instruct-2507"

[orchestrator]
batch_size = 32
rollouts_per_example = 8
oversampling_factor = 2.0
max_async_level = 2

[orchestrator.sampling]
max_tokens = 4096

[[orchestrator.env]]
id = "injection-trainer"
name = "injection-trainer"
args = { attack_modes = ["memory"], defense_levels = ["hard"], max_turns = 6, seed = 42 }

[orchestrator.buffer]
online_difficulty_filtering = true
easy_threshold = 0.8
hard_threshold = 0.2
easy_fraction = 0.2
hard_fraction = 0.2

[orchestrator.val]
num_examples = 32
rollouts_per_example = 4
interval = 5

[orchestrator.eval]
interval = 20
num_examples = 100
rollouts_per_example = 1

[[orchestrator.eval.env]]
id = "injection-trainer"
args = { attack_modes = ["memory"], defense_levels = ["hard"], max_turns = 6 }

[trainer]

[inference]
